// Init jquery picture, float labels, fit text
function pageLoad(){
  // Variables
  if(!(/iPhone|iPod/i).test(navigator.userAgent || navigator.vendor || window.opera)){
    var windowHeight = $(window).height();
  }
  else {
      var windowHeight = $(window).height() + 70;
  }

  var windowWidth = $(window).width();
  var headerHeight = $('#main-nav').outerHeight();
  var appNavHeight = $('#app-nav').outerHeight();

  $(window).resize(function() { 
    if(!(/iPhone|iPod/i).test(navigator.userAgent || navigator.vendor || window.opera)){
        windowHeight = $(window).height();
    }
    else {
        windowHeight = $(window).height() + 70;
    }

    windowWidth = $(window).width();
    headerHeight = $('#main-nav').outerHeight();
    appNavHeight = $('#app-nav').outerHeight();
  });
  //////

  // Init float labels
  $('.floatlabel').floatlabel({
      slideInput: true,
      labelStartTop: '.2em',
      labelEndTop: '.2em',
      transitionDuration: '0.3s'
  });

  // Init slab text
  $('.slab').slabText();

  // Init tab bar
  $('#app-nav').tabBar(headerHeight);
  

  // Index splash sizing
  $('.splash.full-page').css('min-height', windowHeight - headerHeight - appNavHeight); 
  $('.splash.full-page-app').css('min-height', windowHeight - appNavHeight); 

  $(window).resize(function() {
    $('.splash.full-page').css('min-height', windowHeight - headerHeight - appNavHeight); 
    $('.splash.full-page-app').css('min-height', windowHeight - appNavHeight); 
  });

  // Init reminder side bar
  $('#reminder-sidebar-toggle').sidr({
    side: 'right',
    body: '#send-page .outer-container',
    onOpen: function() {
      // Reminder side bar list tiny scrollbar init
      //$('.reminder-sidebar ul.reminder-list').tinyscrollbar();
    }
  });

  // Reminder side bar sizing
  var reminderSidebarHeight = $('.reminder-sidebar').height();
  var reminderSidebarTitleHeight = $('.reminder-sidebar .inner .title').actualOuterHeight(true);
  var reminderSidebarColumnHeadersHeight = $('.reminder-sidebar .column-headers').actualOuterHeight(true);
  var reminderEditNavHeight = $('#reminder-edit-nav').actualHeight();

  $(window).resize(function() {
    reminderSidebarHeight = $('.reminder-sidebar').height();
    reminderSidebarTitleHeight = $('.reminder-sidebar .inner .title').actualOuterHeight(true);
    reminderSidebarColumnHeadersHeight = $('.reminder-sidebar .column-headers').actualOuterHeight(true);
    reminderEditNavHeight = $('#reminder-edit-nav').actualHeight();
  });

  $('.reminder-sidebar ul.reminder-list').css('height', reminderSidebarHeight - reminderSidebarTitleHeight - reminderSidebarColumnHeadersHeight - reminderEditNavHeight);

  // Size specific functions
  //
  // Mobile size only

  if ($('html').css('font-size') == '42.5%') {
    smoothHashNav(0);
  }
  // Not mobile size
  else {
    // Init smooth hash scrolling
    smoothHashNav(appNavHeight);
  }
};

$(function(){
  // On document ready
  pageLoad();

  // On modal open
  $('body').on($.modal.OPEN, function(event, modal) {
    pageLoad();
    $('body').addClass('stop-scrolling');
    $('body').bind('touchmove', function(e){e.preventDefault()});
  });

  // On modal close
  $('body').on($.modal.CLOSE, function(event, modal) {
    $('body').removeClass('stop-scrolling');
    $('body').unbind('touchmove');
  });
});